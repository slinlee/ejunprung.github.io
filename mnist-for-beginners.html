---
title: MNIST for Beginners
layout: article
---

<header>
  <h1>MNIST for Beginners</h1>
  <p>In this tutorial, we’ll classify the MNIST dataset, the “Hello World” of machine learning.</p>
  <ol class="toc">
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#mnist-dataset">The MNIST Dataset</a></li>
    <li><a href="#configuring">Configuring the MNIST Example</a></li>
    <li><a href="#building">Building Our Neural Network</a></li>
    <li><a href="#training">Training Your Model</a></li>
    <li><a href="#evaluating">Evaluating The Results</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
  </ol>
</header>
  <p>Estimated time to completion is 30 minutes.</p>
<section>
  <h2 id="introduction">Introduction</h2>
  <img src="/img/mnist_render.png"><br><br>
  <p>MNIST is a database containing images of handwritten digits, with each image labeled by integer. It is used to benchmark the performance of machine learning algorithms. Deep learning performs quite well on MNIST, achieving more than 99.7% accuracy.</p>
  <p>We will use MNIST to train a neural network to look at each image and predict the digit. The first step is to install Deeplearning4j.</p>
  <a href="quickstart" type="button" class="btn btn-lg btn-success">GET STARTED WITH DEEPLEARNING4J</a>
</section>

<section>
  <h2 id="mnist-dataset">The MNIST Dataset</h2>
  <p>The MNIST dataset contains a <b>training set</b> of 60,000 examples, and a <b>test set</b> of 10,000 examples. The training set is used to teach the algorithm to predict the correct label, the integer, while the test set is used to check how accurately the trained network can make guesses.</p>
  <p>In the machine learning world, this is called <a href="https://en.wikipedia.org/wiki/Supervised_learning" target="_blank">supervised learning</a>, because we have the correct answers for the images we’re making guesses about. The training set can therefore act as a supervisor, or teacher, correcting the neural network when it guesses wrong.</p>
</section>

<section>
  <h2 id="configuring">Configuring the MNIST Example</h2>
  <p>We’ve packaged the MNIST tutorial into Maven, so there’s no need to write code. Please open IntelliJ to get started. (To download IntelliJ, see our <a href="quickstart">Quickstart…</a>)</p>
  <p>Open the folder labeled <code>dl4j-examples</code>. Go to the directories src → main → java → feedforward → mnist, and open the file <code>MLPMnistSingleLayerExample.java</code>.</p>
  <img src="/img/mlp_mnist_single_layer_example_setup.png"><br><br>
  <p>In this file, we will configure the neural network, train a model and evaluate the results. It will be helpful to view this code alongside the tutorial.</p>
  <h3>Setting Variables</h3>
  <div class="code-window"><code class="language-java">
    final int numRows = 28; // The number of rows of a matrix.
    final int numColumns = 28; // The number of columns of a matrix.
    int outputNum = 10; // Number of possible outcomes (e.g. labels 0 through 9).
    int batchSize = 128; // How many examples to fetch with each step.
    int rngSeed = 123; // This random-number generator applies a seed to ensure that the same initial weights are used when training. We’ll explain why this matters later.
    int numEpochs = 15; // An epoch is a complete pass through a given dataset.
  </code></div>
  <p>In our example, each MNIST image is 28x28 pixels, which means our input data is a 28 <b>numRows</b> x 28 <b>numColumns</b> matrix (matrices are the fundamental data structures of deep learning). Furthermore, MNIST contains 10 possible outcomes (the labels numbered 0 - 9) which is our <b>outputNum</b>.</p>
  <p>The <b>batchSize</b> and <b>numEpochs</b> have to be chosen based on experience; you learn what works through experimentation. A larger batch size results in faster training, while more epochs, or passes through the dataset, result in better accuracy.</p>
  <p>However, there are diminishing returns beyond a certain number of epochs, so there is a trade off between accuracy and training speed. In general, you’ll need to experiment to discover the optimal values. We’ve set reasonable defaults in this example.</p>
  <h3>Fetching the MNIST Data</h3>
  <div class="code-window"><code class="language-java">
    DataSetIterator mnistTrain = new MnistDataSetIterator(batchSize, true, rngSeed);
    DataSetIterator mnistTest = new MnistDataSetIterator(batchSize, false, rngSeed);
  </code></div>
  <p>The class called “DataSetIterator” is used to fetch the MNIST dataset. We create one dataset “mnistTrain” for <b>training the model</b> and another dataset “mnistTest” for <b>evaluating the accuracy</b> of our model after training. The model, by the way, refers to the parameters of the neural network. Those parameters are coefficients that process signal from the input, and they are adjusted as the network learns until they can finally guess the correct label for each image; at that point, you have an accurate model.</p>
</section>

<section>
  <h2 id="building">Building Our Neural Network</h2>
  <p>We’ll build a feedforward neural network based off a <a href="http://jmlr.org/proceedings/papers/v9/glorot10a/glorot10a.pdf" target="_blank">paper by Xavier Glorot and Yoshua Bengio</a>. For our purposes, we’ll start with a basic example with only one hidden layer. However, as a rule of thumb, the deeper your network (i.e. the more layers), the more complexity and nuance it can capture to produce accurate results.</p>
  <img src="/img/onelayer.png"><br><br>
  <p>Keep this image in mind, because this is what we’re constructing, a single layer neural network.</p>
  <h3>Setting Hyperparameters</h3>
  <p>For any neural network you build in Deeplearning4j, the foundation is the <a href="http://deeplearning4j.org/neuralnet-configuration.html" target="_blank">NeuralNetConfiguration class</a>. This is where you configure hyperparameters, the quantities that define the architecture and how the algorithm learns. Intuitively, each hyperparameter is like one ingredient in a meal, a meal that can go very right, or very wrong… Luckily, you can adjust hyperparameters if they don’t produce the right results.</p>
  <div class="code-window"><code class="language-java">
    MultiLayerConfiguration conf = new NeuralNetConfiguration.Builder()
            .seed(rngSeed)
            .optimizationAlgo(OptimizationAlgorithm.STOCHASTIC_GRADIENT_DESCENT)
            .iterations(1)
            .learningRate(0.006)
            .updater(Updater.NESTEROVS).momentum(0.9)
            .regularization(true).l2(1e-4)
            .list()
  </code></div>
  <h4>.seed(rngSeed)</h4>
</section>

<section>
  <h2 id="training">Training Your Model</h2>
  <img src="/img/mnist_render.png"><br>
  <p>MNIST is a database containing images of handwritten digits, with each image labeled by integer. It is used to benchmark the performance of machine learning algorithms. Deep learning performs quite well on MNIST, achieving more than 99.7% accuracy.</p>
  <p>We will use MNIST to train a neural network to look at each image and predict the digit. The first step is to install Deeplearning4j.</p>
</section>

<section>
  <h2 id="evaluating">Evaluating The Results</h2>
  <img src="/img/mnist_render.png"><br>
  <p>MNIST is a database containing images of handwritten digits, with each image labeled by integer. It is used to benchmark the performance of machine learning algorithms. Deep learning performs quite well on MNIST, achieving more than 99.7% accuracy.</p>
  <p>We will use MNIST to train a neural network to look at each image and predict the digit. The first step is to install Deeplearning4j.</p>
</section>

<section>
  <h2 id="conclusion">Conclusion</h2>
  <img src="/img/mnist_render.png"><br>
  <p>MNIST is a database containing images of handwritten digits, with each image labeled by integer. It is used to benchmark the performance of machine learning algorithms. Deep learning performs quite well on MNIST, achieving more than 99.7% accuracy.</p>
  <p>We will use MNIST to train a neural network to look at each image and predict the digit. The first step is to install Deeplearning4j.</p>
</section>
